# Product Context

Этот файл содержит высокоуровневый контекст проекта и знания о продукте. Он будет обновляться по мере развития проекта и использоваться для информирования всех режимов о целях и контексте проекта.
2025-09-21 07:00:00 - Инициализация контекста продукта на основе `projectBrief.md`, `CLUSTER-README.md`, `QUICK-START.md`, `k8s/KEYCLOAK-README.md`, `ingress.yaml` и `registries.yaml`.

## Цель проекта

*   Автоматизированная система развертывания и управления кластером k3d для ML-платформы с поддержкой Java микросервисов. Цель - предоставить платформу для развертывания и управления ML-моделями и связанными микросервисами.

## Ключевые особенности

*   Развертывание кластера k3d с 2 серверами и 2 агентами.
*   Встроенный Docker Registry.
*   Использование PostgreSQL для баз данных.
*   MinIO для S3-совместимого хранилища.
*   Keycloak для аутентификации и авторизации.
*   Поддержка ModelMesh Serving для ML-моделей.
*   Развертывание Java микросервисов через Ingress.
*   Автоматическая генерация паролей и сохранение в `.env`.
*   Утилиты для управления кластером, сервисами, port-forwarding и shell-доступом.
*   Мониторинг и отладка (логи, статус подов, сервисов, Ingress).
*   Механизмы обновления конфигурации и образов.

## Общая архитектура

*   **Инфраструктура:** Кластер k3d (`ml-cluster`) с 2 серверами и 2 агентами.
*   **Реестр:** Локальный Docker Registry (`k3d-ml-registry:5050`).
*   **Пространства имен (Namespaces):**
    *   `model-registry` для основных сервисов (PostgreSQL, MinIO, Keycloak, ModelMesh Serving).
    *   `services` для Java микросервисов.
*   **Основные компоненты:**
    *   **PostgreSQL:** База данных для Keycloak и, возможно, других сервисов.
    *   **MinIO:** Объектное хранилище, S3-совместимое.
    *   **Keycloak:** Система управления идентификацией и доступом (IAM) с Realm `model-registry-realm`, Client `model-registry-app` и тестовым пользователем `alice`.
    *   **ModelMesh Serving:** Компонент для развертывания и обслуживания ML-моделей.
    *   **Java микросервисы:** Три микросервиса, развертываемые через Ingress.
*   **Сетевая инфраструктура:**
    *   Traefik как Ingress контроллер.
    *   Ingress для ModelMesh Serving (`/v2` путь к сервису `model-registry` на порту `8008`).
    *   Ingress для Java микросервисов.
*   **Управление:** Скрипты `cluster.sh`, `scripts/deploy-cluster.sh`, `scripts/destroy-cluster.sh`, `scripts/manage-services.sh` для автоматизации развертывания и управления.
*   **Конфигурация:** Файлы `.yaml` в `k8s/` для развертывания Kubernetes ресурсов, `registries.yaml` для настройки реестра, `ingress.yaml` для Ingress ModelMesh.